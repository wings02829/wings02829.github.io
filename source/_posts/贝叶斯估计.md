---
title: 贝叶斯估计笔记（抄书）
date: 2025-10-30
tags:
- 参数估计
categories: 数学
toc: true
mathjax: true
--- 
用电子格式是因为上课没听讲==，遂用此办法自学

### 1.基本思想：频率学派与频率贝叶斯学派
频率学派的做法：固定模型中的参数$\theta$，一维情况比如二项分布$B(1,p)$中的$p$，利用总体分布和样本信息去拟合p，其结果是样本均值是$p$的无偏估计，我们也常常这样估计$p$。采取这种做法，我们认为$\theta$是确定但未知的，无论怎样用样本信息估计，在解决实际问题中，都要先有样本的值才能给出$p$的估计$\hat{p}$。
而贝叶斯学派利用上了“先验信息”。利用我们总结的经验，可以猜想参数可能如何变化。还在一维情况举例，比如认为$\theta$应该集中在一个有限区间上，而在其它位置几乎不可能有所分布，此时就可以认为$\theta$也是个随机变量，其有一个分布，且我们还未做抽样，即未作试验获取参数的信息，这个分布被称为“先验分布”。而在作试验后，即有了样本信息，其携带参数信息，可以对我们的先验分布做些修正，使其更为合理，此为“后验分布”，因为我们作了试验。

### 2.后验分布——贝叶斯公式
使用到的符号：总体密度$p(x;\theta)$；在取定 $\theta$ 时的总体密度$p(x|\theta)$；先验分布$\pi(\theta)$。

$\theta$ 为 $\theta_0$ 时的n个样本的联合概率密度为$$p(x_1,...,x_n,|\theta_0)=\prod_{i=1}^n p(x_i|\theta_0)$$。简记$X=(x_1,...,x_n)$。综合所有的$\theta$得到样本$X_i$和$\theta$的联合概率密度为$$h(X,\theta)=p(X|\theta)\pi(\theta)$$。$h(X,\theta)$还可写为$\pi(\theta|X)m(X)$，$m(X)$是$X$的边际密度函数$$m(X)=\int_{\Theta}h(X|\theta)\pi(\theta)d\theta$$，它和$\theta$无关。从而有所谓的后验分布（利用样本信息对先验分布调整）：$$\pi(\theta|X)=\frac{p(X|\theta)\pi(\theta)}{\int_{\Theta}h(X|\theta)\pi(\theta)d\theta}$$，其为贝叶斯公式。

### 3.贝叶斯估计
用法：

1.最大后验估计；

2.后验中位数估计；

3.后验期望估计——贝叶斯估计$\hat{\theta_B}$

同等无知：假设$B(1,p)$中的$p$服从均匀分布$U(0,1)$。

#### ex1.
题目：利用同等无知原则求二项分布$B(1,\theta)$中的$\theta$的贝叶斯估计

设n个样本中事件发生次数X，则$P(X=x|\theta)=C_n^x\theta^x(1-\theta)^{n-x}$，进而后验估计为$$\pi(\theta|X)=\frac{\theta^x(1-\theta)^{n-x}}{\int_0^1\theta^x(1-\theta)^{n-x}d\theta}=\frac{\theta^x(1-\theta)^{n-x}}{Beta(x+1,n-x+1)}$$，说明此时的$\theta|X$服从于Beta分布$Beta(x+1,n-x+1)$，期望即贝叶斯估计为$$\hat{\theta_B}=E[\theta|X]=\frac{Beta(x+2,n-x+1)}{Beta(x+1,n-x+1)}=\frac{x+1}{n+2}$$。

#### ex2.
题目：一个正态总体$N(\mu ,{\sigma_0}^2) $，参数为$\mu$的贝叶斯估计，这里$\{sigma_0}^2$ 给定。假设$\mu$的先验分布也是一个正态分布$N(\theta,{\tau}^2)$，其中$\theta$和$\tau^2$都已知。样本是$X_i$，其中$i=1,...,n$。

可以写出$h(X,\mu)=\frac{1}{(2\pi)^{\frac{n+1}{2}}\sigma_0^n\tau}\exp\{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2-\frac{1}{2\tau^2}(\mu-\theta)^2\}$。

记$k=\frac{1}{(2\pi)^{\frac{n+1}{2}}\sigma_0^n\tau}$，$A=\frac{n}{\sigma^2}+\frac{1}{\tau^2}$，$B=\frac{n\overline{x}}{\sigma^2}+\frac{\theta}{\tau^2}$，$C=\frac{\sum x_i^2}{\sigma^2}+\frac{\theta^2}{\tau^2}$，其中$\overline{x}$则为样本均值，则$$\begin {aligned}h(X,\mu)&=k\exp\{-\frac{1}{2}(A\mu^2-2B\mu+C)\}\\&=k\exp\{-\frac{1}{2\frac{1}{A}}(\mu-\frac{B}{A})^2-\frac{1}{2}(C-\frac{B^2}{A})\} \end {aligned}$$，从而X的边缘密度$m(X)=k\exp\{-\frac{1}{2}(C-\frac{B^2}{A})\}\sqrt{\frac{2\pi}{A}}$，然后知后验估计为$$\pi(\theta|X)=\sqrt{\frac{A}{2\pi}}\exp\{-\frac{1}{2\frac{1}{A}}(\mu-\frac{B}{A})^2\}$$，可以看出这是期望为$\frac{B}{A}$,方差为$\frac{1}{A}$的正态分布，其贝叶斯估计为$$\hat{\mu_B}=\frac{B}{A}=\frac{n\tau^2\overline{x}+\sigma^2\theta}{n\tau^2+\sigma^2}=\frac{\frac{n}{\sigma^2}}{\frac{n}{\sigma^2}+\frac{1}{\tau^2}}\overline{x}+\frac{\frac{1}{\tau^2}}{\frac{n}{\sigma^2}+\frac{1}{\tau^2}}\theta$$。
注：此题中的$\pi(\theta|X)$和$\pi(\theta)$都是正态分布，此时称这个分布为参数$\theta$的共轭分布。不难看出确定为共轭需要加一些条件，比如此题中$\mu$的分布的方差是已知的。